<!-- GFM-TOC -->
* [OSI7层协议](#OSI7层协议)
* [运输层协议概述](#运输层协议概述)
* [UDP报头格式](#UDP报头格式)
* [TCP报头格式](#TCP报头格式)
<!-- GFM-TOC -->

## OSI7层协议
https://github.com/CyC2018/Interview-Notebook/blob/master/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.md#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84
https://www.cnblogs.com/kangfeng/p/8422235.html（主要看图的对比）
http://blog.sina.com.cn/s/blog_60e96a410100my15.html（最后一段）

分层协议好处：
* 各层之间是独立的。某一层并不需要知道他的下一层是如何实现，仅需要知道该层的接口所提供的服务。
* 灵活性好。当任何一层发生变化时（如技术的变化），只要曾间接口关系不变，则在这层以上或以下各层均不受影响。
* 结构上可分割。各层都可以采用最合适的技术来实现。
* 易于实现和维护。因为整个系统已被分解为若干个相对独立的子系统。
* 能促进标准化工作，因为每一层的功能及其所提供的服务都已有了精确的说明。

## 运输层协议概述
* 通信的真正端点并不是主机而是主机中的进程，运输层提供应用进程间的逻辑通信。运输层向高层用户屏蔽了下面网络层的核心细节，使应用程序看起来像是在两个运输层实体之间有一条端到端的逻辑通信信道。运输层有两种不同的运输协议，即面向连接的TCP和无连接的UDP。
* TCP/IP的运输层用一个16位的端口号标志一个端口，标志计算机应用层中的各个进程和运输层交互时的层间接口。常用的服务端端口号：
    * FTP : 21
    * SSH : 22
    * TELNET : 23
    * SMTP : 25
    * DNS : 53
    * HTTP : 80
    * POP3 : 110
    * HTTPS : 443
    * SOCKETS : 1080

### 用户数据报协议UDP特点
* UDP是无连接的。即发送数据之前不需要建立连接（发送数据结束也没有连接可释放），减少了开销以及发送数据之前的延迟。
* UDP尽最大努力交付。即不保证可靠交付，主机不需要维持复杂的连接状态表。
* UDP是面向报文的。发送方的UDP对应用程序交下来的报文，添加首部后就交付给了IP层，应用层交给UDP多长的报文，UDP就照样放松，即一次发送一个报文。在接收方的UDP，对IP层交上来的报文，去除首部后就交给上层的应用进程。
* UDP没有拥塞控制。
* 支持一对一、一对多、多对一、多对多交互通信。
* UDP首部开销小。

### 传输控制协议TCP特点
* TCP是面向连接的运输层协议。应用程序在使用TCP协议之前，必须先建立TCP连接，传送完数据后，必须释放TCP连接。
* TCP提供可靠交付的服务。通过TCP连接传送的数据，无差错、不丢失、不重复、并且按序到达。
* TCP面型字节流。“流”指的是流入到进程或从进程流出的字节序列。TCP把应用程序交下来的数据看成是一连串无结构的字节流。TCP和UDP在发送报文时所采用的方式完全不同。TCP对应用进程一次把多长的报文发送到TCP的缓存中是不关心的。TCP根据对方给出的窗口值和当前网络拥塞的程度来决定一个报文段应包含多少个字节（UDP发送报文长度是进程给出的）。如果应用进程传送到TCP缓存的数据块太长，TCP就可以把它划分短一些在传送。如果应用进程一次只发来一个字节，TCP也可以等待积累有足够多的字节后在构成报文段发送出去。
* TCP提供全双工通信。
* 每一条TCP连接只能有两个端点（套接字所确定）。

## UDP报头格式
https://github.com/CyC2018/Interview-Notebook/blob/master/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.md#udp-%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F

其中部分字段意义：
* 长度：UDP用户数据报的长度，其最小值是8（仅有首部）。 
* 检验和：检测UDP用户数据报在传输中是否有错。有错就丢弃。

伪首部并不是UDP用户数据报真正的首部，只在计算检验和时，临时添加在UDP用户数据报前面，得到一个临时的UDP用户数据报。
https://blog.csdn.net/stpeace/article/details/73699603

## TCP报头格式
https://github.com/CyC2018/Interview-Notebook/blob/master/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.md#tcp-%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F

其中部分字段意义：
* URG：表示本报文段中发送的数据是否包含紧急数据。URG=1，表示有紧急数据。后面的紧急指针字段只有当URG=1时才有效。
* PSH：告诉对方收到该报文段后是否应该立即把数据推送给上层。如果为1，则表示对方应当立即把数据提交给上层，而不是缓存起来。
* RST：只有当RST=1时才有用。如果你收到一个RST=1的报文，说明你与主机的连接出现了严重错误（如主机崩溃），必须释放连接，然后再重新建立连接。或者说明你上次发送给主机的数据有问题，主机拒绝响应。
